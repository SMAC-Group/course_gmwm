---
type: slides
---

# Example: Saving rates

---


The following example is from economy. The goal is to analyse the evolution of saving rates over last 60 years and see if this could be represented by a stochastic model. First, we load the data from the `simts` package and plot it. 

```r
# Load savingrt dataset
data(savingrt, package = "simts")

# Simulate based on data
savingrt = gts(as.vector(savingrt), start = 1959, freq = 12)
```

---

```r
# Plot savingrt
plot(savingrt)
```

<div style="text-align:center"><img src="sav1-1.png" alt=" " width="85%">

---

Then we calculate the WV with the standard and robust estimators.

```r
# Plot wv
wv = wvar(savingrt)
wv_rob = wvar(savingrt, robust = TRUE)
compare_wvar(wv, wv_rob, split = FALSE)
```

<div style="text-align:center"><img src="sav2-1.png" alt=" " width="90%">

---

We observe significant differences on the first two smallest scales. As such *extreme variations* may affect the model in consideration we base the parameter matching on the robust version of the estimator and suggest `RW() + AR1()` as a model structure. 

```r
mod = gmwm(RW() + AR1(), savingrt, robust = TRUE)
plot(mod)
```

<div style="text-align:center"><img src="sav3-1.png" alt=" " width="90%">

---

```r
summary(mod, inference = TRUE)
```

```out
Model Information: 
          Estimates       CI Low      CI High         SE
RW     1.614414e-01 1.369535e-01 1.812333e-01 0.01346012
AR1    9.999932e-01 9.999932e-01 9.999932e-01 0.00000000
SIGMA2 2.220446e-16 2.220446e-16 2.220446e-16 0.00000000

> The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
* The initial values of the parameters used in the minimization of the GMWM objective function 
  were generated by the program underneath seed: 1337. 

Objective Function: 0.749

Bootstrapped Goodness of Fit: 
Test Statistic: 0.75
P-Value: 0.02  CI: (0, 0.05)


To replicate the results, use seed: 1337
```


---

Although the implied WV stays within the confidence region of the empirical WV, the general trend is not very well followed by this model. However, this maybe well be due to the initialasation of parameters that converged to a local minimum. Hence, we initiate the parameters with fixed values and run the again the estimation. 

```r
mod = gmwm(RW(gamma2 = 0.1) + AR1(phi = 0.8, sigma2 = 0.1), savingrt, robust = TRUE)
plot(mod)
```

<div style="text-align:center"><img src="sav4-1.png" alt=" " width="90%">

---

```r
summary(mod, inference = TRUE)
```

```out
Model Information: 
        Estimates     CI Low    CI High         SE
RW     0.04803446 0.01172827 0.07362965 0.01881668
AR1    0.87697832 0.77524457 0.96058769 0.05634031
SIGMA2 0.13568898 0.10762580 0.17429901 0.02026722

> The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
* The initial values of the parameters used in the minimization of the GMWM objective function 
  were given by YOU! 

Objective Function: 0.0122

Bootstrapped Goodness of Fit: 
Test Statistic: 0.01
P-Value: 1  CI: (1, 1)


To replicate the results, use seed: 1337
```

---

Now the resulting correspondences between the empirical and implied WV are in a good agreement over large number of scales, especially in the region where the confidence of WV is high. Hence, we consider the resulting value of parameters to be plausible for modelling. 