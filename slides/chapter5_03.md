---
type: slides
---

# Example: MTi-G Gyroscope with contaminated measurements
---

This example considers another experiment which is based on the same sensor used in our previous example. The data can be loaded from the `imudata` R package as follows:

```r
# Load MTi-G MEMS-IMU @100Hz - Gyro X
data(cont.imu1, package = "imudata")
```

---

The data are already in the right format so we can directly use it. Since we suspect that the data might be contaminated by outliers, we first compare the classical and robust WV:

```r
wv = wvar(cont.imu1)
wv_rob = wvar(cont.imu1, robust = TRUE)
compare_wvar(wv, wv_rob, split = FALSE) 
```

<div style="text-align:center"><img src="gmwm31-1.png" alt=" " width="90%"></div>

---

The difference is clearly significant between the two estimators. Therefore, we will use the robust estimator for this example. Since we consider the model `3*AR1()` as the "best" model for our other dataset which considers the same sensor, we use this model as our initial guess:

```r
mod1 = gmwm(3*AR1(), cont.imu1, robust = TRUE)
plot(mod1)
```

<div style="text-align:center"><img src="gmwm32-1.png" alt=" " width="90%"></div>

---

```r
summary(mod1, inference = TRUE)
```

```out
## Model Information: 
##           Estimates        CI Low      CI High           SE
## AR1    9.582837e-01  9.582815e-01 9.582858e-01 1.311196e-06
## SIGMA2 5.476432e-10 -1.820779e-09 2.916066e-09 1.439899e-09
## AR1    9.957771e-01  9.947880e-01 9.967662e-01 6.013472e-04
## SIGMA2 8.927788e-10  5.624869e-10 1.223071e-09 2.008032e-10
## AR1    1.385728e-01  1.384621e-01 1.386834e-01 6.726680e-05
## SIGMA2 2.200131e-05  2.194129e-05 2.206133e-05 3.648910e-08
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 4.4208
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 248 on 12 degrees of freedom
## The resulting p-value is: 0
```

---

The result seems to suggest that one of the `AR1()` process is not necessary. Therefore, we consider the model `2*AR1()` instead:

```r
mod2 = gmwm(2*AR1(), cont.imu1, robust = TRUE)
plot(mod2)
```

<div style="text-align:center"><img src="gmwm33-1.png" alt=" " width="90%"></div>

---

```r
summary(mod2, inference = TRUE)
```

```out
## Model Information: 
##           Estimates       CI Low      CI High           SE
## AR1    9.946183e-01 9.936590e-01 9.955776e-01 5.832107e-04
## SIGMA2 1.214890e-09 9.110021e-10 1.518779e-09 1.847509e-10
## AR1    1.382817e-01 1.359113e-01 1.406522e-01 1.441111e-03
## SIGMA2 2.199745e-05 2.193756e-05 2.205733e-05 3.640719e-08
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 4.5557
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 280.94 on 14 degrees of freedom
## The resulting p-value is: 0
```

---

This model appears to provide a reasonable fit. It is interesting to compare the result with the non-robust estimator:

```r
mod3 = gmwm(2*AR1(), cont.imu1)
plot(mod3)
```

<div style="text-align:center"><img src="gmwm34-1.png" alt=" " width="90%"></div>

---

```r
summary(mod3, inference = TRUE)
```

```out
## Model Information: 
##           Estimates       CI Low      CI High           SE
## AR1    9.939795e-01 9.927429e-01 9.952161e-01 7.518070e-04
## SIGMA2 1.176002e-09 8.283696e-10 1.523635e-09 2.113456e-10
## AR1    1.607737e-02 1.388108e-02 1.827366e-02 1.335249e-03
## SIGMA2 3.154224e-05 3.146745e-05 3.161703e-05 4.546956e-08
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 4.2688
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 175.86 on 14 degrees of freedom
## The resulting p-value is: 0
```

The result is clearly different and indicates that a robust approach is likely to be beneficial.