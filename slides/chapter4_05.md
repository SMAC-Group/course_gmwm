---
type: slides
---

# Example: Hydrology

---


In the following example we try to find a model that characterizes the observed precipitations per month over number of years. First we load the precipitation data and plot them. 

```r
# Load hydro dataset
data(hydro, package = "simts")

# Simulate based on data
hydro = gts(as.vector(hydro), start = 1907, freq = 12)
```

---

```r
# Plot hydro
plot(hydro)
```

<div style="text-align:center"><img src="hydro1-1.png" alt=" " width="85%">

---

Then we estimate WV using both standard and robust approach and compare them. Noting that in this case the observed data are not necessary *outliers* in terms of observations. However, the *robust* estimation de-weights the influence of extreme precipitation events on the model.

```r
# Plot wv
wv = wvar(hydro)
wv_rob = wvar(hydro, robust = TRUE)
compare_wvar(wv, wv_rob, split = FALSE)
```

<div style="text-align:center"><img src="hydro2-1.png" alt=" " width="85%">

---

Finally we suggest a model and observe its correspondences with the empirical time series.

```r
mod = gmwm(AR1(), hydro, robust = TRUE)
plot(mod)
```

<div style="text-align:center"><img src="hydro3-1.png" alt=" " width="85%">

---

```{r, cache=TRUE}
summary(mod)
```

```out
## Model Information: 
##        Estimates     CI Low   CI High          SE
## AR1    0.4048704 0.33448311 0.4661902 0.040036116
## SIGMA2 0.1065875 0.09623502 0.1175341 0.006474454
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 0.0187
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 0.02
## P-Value: 0.81  CI: (0.73, 0.88)
## 
## 
## To replicate the results, use seed: 1337
```

---

These results can be compared to the classical GMWM: 

```r
mod = gmwm(AR1(), hydro)
plot(mod)
```

<div style="text-align:center"><img src="hydro4-1.png" alt=" " width="85%">

---

```{r, cache=TRUE}
summary(mod)
```

```out
## Model Information: 
##         Estimates     CI Low   CI High         SE
## AR1    0.06741115 0.02576541 0.1171602 0.02778205
## SIGMA2 0.21811907 0.19875097 0.2367281 0.01154424
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 0.0631
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 0.06
## P-Value: 0.5  CI: (0.4, 0.6)
## 
## 
## To replicate the results, use seed: 1337
```

---