---
type: slides
---

# Example: IMAR - Gyroscope

---

This example considers data obtained from IMAR gyroscope. The data can be loaded from the `imudata` R package as follows:

```r
# Load IMAR
data(imar.gyro, package = "imudata")

# Let's pick gyro X
Xt = imar.gyro[,1]
```

---

As in our previous examples, we start by computing and plotting the WV: 

```r
# Plot wv 
plot(wvar(Xt))
```

<div style="text-align:center"><img src="gmwm49-1.png" alt=" " width="80%"></div>

---

The WV indicates that the data are "close" to a `WN()`:

```r
mod1 = gmwm(WN(), Xt)
plot(mod1)
```

<div style="text-align:center"><img src="gmwm50-1.png" alt=" " width="90%"></div>

---

```r
summary(mod1, inference = TRUE)
```

```out
Model Information: 
      Estimates       CI Low      CI High           SE
WN 2.406307e-07 2.404574e-07 2.408039e-07 1.053435e-10

* The initial values of the parameters used in the minimization of the GMWM objective function 
  were generated by the program underneath seed: 1337. 

Objective Function: 344.5788

Asymptotic Goodness of Fit: 
Test Statistic: 14005.51 on 21 degrees of freedom
The resulting p-value is: 0
```

---

The fit is quite good but an `AR1()` may provide a better fit:

```r
mod2 = gmwm(AR1(), Xt)
plot(mod2)
```

<div style="text-align:center"><img src="gmwm51-1.png" alt=" " width="90%"></div>

---

```r
summary(mod2, inference = TRUE)
```

```out
Model Information: 
          Estimates       CI Low      CI High           SE
AR1    3.486032e-02 3.423157e-02 3.548907e-02 3.822538e-04
SIGMA2 2.411372e-07 2.409672e-07 2.413072e-07 1.033447e-10

* The initial values of the parameters used in the minimization of the GMWM objective function 
  were generated by the program underneath seed: 1337. 

Objective Function: 21.6998

Asymptotic Goodness of Fit: 
Test Statistic: 965.73 on 20 degrees of freedom
The resulting p-value is: 0
```

---

This model appears to provide a better fit (we can also note that the parameter $\phi$ is significantly different from 0). We could consider adding an additonal `AR1()`:

```r
mod3 = gmwm(2*AR1(), Xt)
plot(mod3)
```

<div style="text-align:center"><img src="gmwm52-1.png" alt=" " width="90%"></div>

---

```r
summary(mod3)
```

```out
Model Information: 
          Estimates
AR1    9.227550e-01
SIGMA2 2.311401e-13
AR1    3.480166e-02
SIGMA2 2.411618e-07

* The initial values of the parameters used in the minimization of the GMWM objective function 
  were generated by the program underneath seed: 1337. 

Objective Function: 21.7559
```

---

This last model does not appear to bring any additonal benefits. Finally, we can compare the models as follows:

```r
compare_models(mod1, mod2, mod3, show.theo.wv = T, facet.label = c('WN', 'AR1', '2*AR1')) 
```

<div style="text-align:center"><img src="gmwm52_2-1.png" alt=" " width="70%"></div>

The model `AR1()` appears to be the most suitable model for this data.

---