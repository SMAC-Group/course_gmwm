---
type: slides
---

# The Generalized Method of Wavelet Moments

The `gmwm` allows to estimate the parameters of various time series models in an efficient and consistent manner. The function which implements this method is called `gmwm()`. There are multiple arguments to this function which provide the users with a flexible range of options to tailor the estimation to their needs. This function relies on users supplying an error model which can be specified using a combination of all or a subset of the following processes:

- `GM()`: a Gauss-Markov process;
- `AR1()`: a first-order auto-regressive process;
- `WN()`: a white noise process;
- `QN()`: quantization noise process;
- `RW()`: a random walk process;
- `DR()`: a drift "process";
- `AR(p)`: a `p`-order auto-regressive process;
- `MA(q)`: a `q`-order moving average process;
- `ARMA(p,q)`: an auto-regressive-moving average process.

---

It  must be underlined  that  a  first-order  auto-regressive  process  (`AR1()`)  is an one-to-one  reparametrization  of  a Gauss-Markov process (`GM()`). The  latent  processes  underlying  the  error  signal,  whose  parameters  need  to  be  estimated,  can  be  specified  by simply adding the different processes mentioned above via the `+` operator. However, there are some limits to how many times a process can be included in a model. In particular, only the `GM()` or `AR1()` models can be included more than once (say `k` times) by specifying, for example, `k*GM()` while the other processes can be included only once within the same model.

---

To illustrate how the function `gmwm()` can be used, we start by considering the AR1() with measurement error we discussed previously.

```r
library(gmwm)
mod = gmwm(AR1() + WN(), Xt)
summary(mod)
```

```out
## Model Information: 
##         Estimates     CI Low   CI High          SE
## AR1    0.97817486 0.97296234 0.9824193 0.002874724
## SIGMA2 0.02135377 0.01797174 0.0246592 0.002032842
## WN     1.01312189 0.98774022 1.0368516 0.014928795
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 0.0322
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 0.03
## P-Value: 0.92  CI: (0.86, 0.97)
## 
## 
## To replicate the results, use seed: 1337
```

---

```r
plot(mod)
```

<div style="text-align:center"><img src="gmwm15-1.png" alt=" " width="100%">

---

The "true" data generating used to generate `Xt` was given by

```r
model
```

```out
## 
## Guess Starting Values: FALSE 
##   Terms Initial.Values
##     AR1           0.98
##  SIGMA2           0.02
##      WN           1.00
## The model will be initiated using the initial values you supplied.
```

---

and therefore the GMWM provides reasonable estimated parameters. We can repeat the same process with the perturbed version of `Xt` which we called `Yt`:

```r
mod_Yt = gmwm(AR1() + WN(), Yt)
summary(mod_Yt)
```

```out
## Model Information: 
##         Estimates     CI Low    CI High          SE
## AR1    0.97496033 0.96890046 0.98003799 0.003385567
## SIGMA2 0.02313008 0.01849443 0.02764566 0.002781776
## WN     2.33909613 2.28186938 2.39262447 0.033667155
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 0.0465
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 0.05
## P-Value: 0.9  CI: (0.83, 0.95)
## 
## 
## To replicate the results, use seed: 1337
```

---

```r
plot(mod_Yt)
```

<div style="text-align:center"><img src="gmwm16-1.png" alt=" " width="100%">


---

In this case, the estimation is quite poor and, for example, the variance of the `WN()` is largely overestimated. Alternatively, we can used the robust estimator as follows:

```r
mod_Yt_rob = gmwm(AR1() + WN(), Yt, robust = TRUE)
summary(mod_Yt_rob)
```

```out
## Model Information: 
##         Estimates     CI Low    CI High          SE
## AR1    0.96922232 0.96196377 0.97528379 0.004048998
## SIGMA2 0.03372423 0.02839866 0.03891439 0.003196554
## WN     0.99026435 0.96296131 1.01669659 0.016334365
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 0.0747
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 0.07
## P-Value: 0.37  CI: (0.26, 0.46)
## 
## 
## To replicate the results, use seed: 1337
```

---

```r
plot(mod_Yt_rob)
```
<div style="text-align:center"><img src="gmwm17-1.png" alt=" " width="100%">


In this case, the result are much closer to the ones obtained on `Xt` and illustrates the robustness of the estimator.
