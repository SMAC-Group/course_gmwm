---
type: slides
---

# Example: MTi-G Gyroscope

---

Our first example considers the gyroscope of an MTi-G MEMS-IMU. The data can be loaded from the `imudata` R package as follows:

```r
# Load MTi-G MEMS-IMU @100Hz
library(gmwm)
data(imu6, package = "imudata")

# Gyro X
Xt = gts(imu6[,1], freq = 100)
```

---

We start by computing and plotting the WV as such plot can provide insights on suitable candidate models:

```r
# Plot wv 
plot(wvar(Xt))
```

<div style="text-align:center"><img src="gmwm23-1.png" alt=" " width="80%"></div>

---

This graph indicates that a `QN`, `RW` and/or `DR` processes do not appear to be present the data at hand. As an initial model we consider `WN() + AR1()`:

```r
# Model 1: WN + AR1()
mod1 = gmwm(WN() + AR1(), Xt)
plot(mod1)
```

<div style="text-align:center"><img src="gmwm24-1.png" alt=" " width="90%"></div>

---

The result indicates that the `WN()` process is not needed and therefore, we remove the `WN()` and add an additional `AR1()` to our model:

```r
# Model 2: 2*AR1()
mod2 = gmwm(2*AR1(), Xt)
plot(mod2)
```

<div style="text-align:center"><img src="gmwm25-1.png" alt=" " width="90%"></div>

---

```{r, cache = TRUE}
summary(mod2, inference = TRUE)
```

```out
## Model Information: 
##           Estimates       CI Low      CI High           SE
## AR1    9.998733e-01 9.998375e-01 9.999090e-01 2.172468e-05
## SIGMA2 5.096429e-11 4.237180e-11 5.955677e-11 5.223857e-12
## AR1    1.266352e-01 1.266352e-01 1.266352e-01 1.692025e-08
## SIGMA2 5.030902e-05 5.021284e-05 5.040520e-05 5.847326e-08
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 20.9941
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 912.83 on 15 degrees of freedom
## The resulting p-value is: 0
```

---

While the fit appears reasonable, it is clear that the match between the empirical and model-based WV could be further improved. Therefore, we consider adding a third `AR1()`:

```r
# Model 3: 3*AR1()
mod3 = gmwm(3*AR1(), Xt)
plot(mod3)
```

<div style="text-align:center"><img src="gmwm26-1.png" alt=" " width="90%"></div>

---

```r
summary(mod3, inference = TRUE)
```

```out
## Model Information: 
##           Estimates       CI Low      CI High           SE
## AR1    9.984905e-01 9.984869e-01 9.984942e-01 2.226994e-06
## SIGMA2 3.676371e-10 3.213510e-10 4.139231e-10 2.813992e-11
## AR1    9.999226e-01 9.998788e-01 9.999664e-01 2.662223e-05
## SIGMA2 1.766927e-11 9.341717e-12 2.599682e-11 5.062793e-12
## AR1    1.255909e-01 1.255909e-01 1.255910e-01 4.000322e-08
## SIGMA2 5.028488e-05 5.018994e-05 5.037982e-05 5.771720e-08
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 17.284
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 609.11 on 13 degrees of freedom
## The resulting p-value is: 0
```

The last model (i.e. `3*AR1()`) appears to provide the best fit but the second (`2*AR1()`) could also be a reasonable candidate in practice for computational reasons. The models can be compared as follows:

---

```r
compare_models(mod1, mod2, mod3, facet.label = c('AR1()', '2*AR1()', '3*AR1()'))
```

<div style="text-align:center"><img src="gmwm27-1.png" alt=" " width="90%"></div>

---

It is unlikely that a more complex model will be more appropriate. For example, a model with four `AR1()` processes does not likely improve anything, nevertheless, it can be tested:

```r
# Model 4: 4*AR1()
mod4 = gmwm(4*AR1(), Xt)
plot(mod4)
```

<div style="text-align:center"><img src="gmwm28-1.png" alt=" " width="90%"></div>

---

```r
summary(mod4, inference = TRUE)
```

```out
## Model Information: 
##           Estimates       CI Low      CI High           SE
## AR1    8.574494e-01 8.574494e-01 8.574494e-01 1.237434e-09
## SIGMA2 2.892776e-08 1.461227e-08 4.324326e-08 8.703202e-09
## AR1    9.986708e-01 9.986665e-01 9.986750e-01 2.586699e-06
## SIGMA2 3.088568e-10 2.619776e-10 3.557360e-10 2.850054e-11
## AR1    9.999237e-01 9.998769e-01 9.999704e-01 2.841018e-05
## SIGMA2 1.726056e-11 8.543800e-12 2.597732e-11 5.299412e-12
## AR1    1.235433e-01 1.235433e-01 1.235434e-01 3.836202e-08
## SIGMA2 5.020302e-05 5.009071e-05 5.031533e-05 6.827951e-08
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 18.7584
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 646.47 on 11 degrees of freedom
## The resulting p-value is: 0
```

---

```r
# Model 5: 5*AR1()
mod5 = gmwm(5*AR1(), Xt)
plot(mod5)
```

<div style="text-align:center"><img src="gmwm29-1.png" alt=" " width="90%"></div>

---

```r
summary(mod5, inference = TRUE)
```

```out
## Model Information: 
##           Estimates        CI Low      CI High           SE
## AR1    9.345016e-01  9.345016e-01 9.345016e-01 9.102736e-10
## SIGMA2 5.437289e-09 -6.282937e-09 1.715752e-08 7.125392e-09
## AR1    9.741799e-01  9.741798e-01 9.741799e-01 6.309472e-09
## SIGMA2 3.067852e-09 -2.283564e-10 6.364060e-09 2.003952e-09
## AR1    9.988620e-01  9.988580e-01 9.988660e-01 2.426310e-06
## SIGMA2 2.324177e-10  1.819189e-10 2.829164e-10 3.070105e-11
## AR1    9.999255e-01  9.998773e-01 9.999738e-01 2.933374e-05
## SIGMA2 1.638095e-11  7.384302e-12 2.537761e-11 5.469576e-12
## AR1    1.240972e-01  1.240971e-01 1.240972e-01 5.052728e-08
## SIGMA2 5.019923e-05  5.008712e-05 5.031135e-05 6.815902e-08
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 18.7834
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 616.96 on 9 degrees of freedom
## The resulting p-value is: 0
```

```r
compare_models(mod3, mod4, mod5, 
               facet.label = c('3*AR1()', '4*AR1()', '5*AR1()'))
```

<div style="text-align:center"><img src="gmwm30-1.png" alt=" " width="90%"></div>

---