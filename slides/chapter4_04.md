---
type: slides
---

# The Generalized Method of Wavelet Moments

---

The `gmwm` allows to estimate the parameters of various time series models in an efficient and consistent manner. The function which implements this method is simply called `gmwm()`. There are multiple arguments to this function which provide the users with a flexible range of options to tailor the estimation to their needs. This function relies on  users supplying an error model which can be specified using a combination of all or a subset of the following processes:

- `GM()`: a Gauss-Markov process;
- `AR1()`: a first-order autoregressive process;
- `WN()`: a white noise process;
- `QN()`: quantization noise process;
- `RW()`: a random walk process;
- `DR()`: a drift "process";
- `AR(p)`: a `p`-order autoregressive process;
- `MA(q)`: a `q`-order moving average process;
- `ARMA(p,q)`: an autoregressive-moving average process.

---

It  must  be  underlined  that  a  first-order  autoregressive  process  (`AR1()`)  is  simply  an one-to-one  reparametrization  of  a Gauss-Markov process (`GM()`). The  latent  processes  underlying  the  error  signal,  whose  parameters  need  to  be  estimated,  can  be  specified  by simply adding the different processes mentioned above via the `+` operator. However, there are some limits to how many times a process can be included in a model. In particular, only the `GM()` or `AR1()` models can be included more than once (say `k` times) by specifying, for example, `k*GM()` while the other processes can only be included once within the same model.

---

To illustrate how the function `gmwm()` can be used we start by considering the AR1() with measrument error we discussed previously. 

```r
mod = gmwm(AR1() + WN(), Xt)
summary(mod)
```

```out
Model Information: 
        Estimates     CI Low    CI High          SE
AR1    0.97422365 0.96829738 0.97910231 0.003284468
SIGMA2 0.01866163 0.01550111 0.02175167 0.001900036
WN     0.96793879 0.94379254 0.99050236 0.014198778

> The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
* The initial values of the parameters used in the minimization of the GMWM objective function 
  were generated by the program underneath seed: 1337. 

Objective Function: 0.1459

Bootstrapped Goodness of Fit: 
Test Statistic: 0.15
P-Value: 0.26  CI: (0.18, 0.34)


To replicate the results, use seed: 1337
```

---

```r
plot(mod)
```

<div style="text-align:center"><img src="gmwm15-1.png" alt=" " width="75%">

The "true" data generating used to generate `Xt` was given by

```r
model
```

```out
AR1	0.98			
SIGMA2	0.02			
WN	1.00	
```

---

and therefore the GMWM provides reasonable estimated parameters. We can repeat the same process with the perturbed version of `Xt` which we called `Yt`:

```r
mod_Yt = gmwm(AR1() + WN(), Yt)
summary(mod_Yt)
```

```out
Model Information: 
        Estimates     CI Low    CI High          SE
AR1    0.97409707 0.96766222 0.97940646 0.003569996
SIGMA2 0.01776823 0.01388855 0.02158705 0.002340179
WN     2.76402433 2.69633055 2.82696960 0.039711451

> The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
* The initial values of the parameters used in the minimization of the GMWM objective function 
  were generated by the program underneath seed: 1337. 

Objective Function: 0.0993

Bootstrapped Goodness of Fit: 
Test Statistic: 0.1
P-Value: 0.65  CI: (0.56, 0.74)


To replicate the results, use seed: 1337
```

---

```r
plot(mod_Yt)
```

<div style="text-align:center"><img src="gmwm16-1.png" alt=" " width="100%">

---

In this case, the estimation is quite poor and, for example, the variance of the `WN()` is largely overestimated. Alternatively, we can used the robust estimator as follows:

```r
mod_Yt_rob = gmwm(AR1() + WN(), Yt, robust = TRUE)
summary(mod_Yt_rob)
```

```out
Model Information: 
        Estimates     CI Low    CI High          SE
AR1    0.96682941 0.95908060 0.97332580 0.004330232
SIGMA2 0.03019888 0.02523696 0.03504493 0.002981409
WN     0.93865336 0.91286336 0.96362854 0.015431521

> The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
* The initial values of the parameters used in the minimization of the GMWM objective function 
  were generated by the program underneath seed: 1337. 

Objective Function: 0.123

Bootstrapped Goodness of Fit: 
Test Statistic: 0.12
P-Value: 0.16  CI: (0.09, 0.24)


To replicate the results, use seed: 1337
```

---

```r
plot(mod_Yt_rob)
```

<div style="text-align:center"><img src="gmwm17-1.png" alt=" " width="100%">

In this case, the result are much closer to the ones obtained on `Xt` and illustrates the robustness of the estimator.
