---
type: slides
---

# The Generalized Method of Wavelet Moments

The `gmwm` allows to estimate the parameters of various time series models in an efficient and consistent manner. The function which implements this method is called `gmwm()`. There are multiple arguments to this function which provide the users with a flexible range of options to tailor the estimation to their needs. This function relies on users supplying an error model which can be specified using a combination of all or a subset of the following processes:

- `GM()`: a Gauss-Markov process;
- `AR1()`: a first-order auto-regressive process;
- `WN()`: a white noise process;
- `QN()`: quantization noise process;
- `RW()`: a random walk process;
- `DR()`: a drift "process";
- `AR(p)`: a `p`-order auto-regressive process;
- `MA(q)`: a `q`-order moving average process;
- `ARMA(p,q)`: an auto-regressive-moving average process.

---

It  must be underlined  that  a  first-order  auto-regressive  process  (`AR1()`)  is an one-to-one  reparametrization  of  a Gauss-Markov process (`GM()`). The  latent  processes  underlying  the  error  signal,  whose  parameters  need  to  be  estimated,  can  be  specified  by simply adding the different processes mentioned above via the `+` operator. However, there are some limits to how many times a process can be included in a model. In particular, only the `GM()` or `AR1()` models can be included more than once (say `k` times) by specifying, for example, `k*GM()` while the other processes can be included only once within the same model.

---

To illustrate how the function `gmwm()` can be used, we start by considering the AR1() with measurement error we discussed previously.

```r
library(gmwm)
mod = gmwm(AR1() + WN(), Xt)
summary(mod)
```

```out
## Model Information: 
##         Estimates     CI Low    CI High          SE
## AR1    0.91839712 0.90424139 0.92965651 0.007725646
## SIGMA2 0.04165177 0.03463035 0.04877674 0.004300196
## WN     0.97482641 0.94926547 0.99865532 0.015013450
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 2.2142
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 2.21
## P-Value: 0.08  CI: (0.03, 0.13)
## 
## 
## To replicate the results, use seed: 1337
```

---

```r
plot(mod)
```

<div style="text-align:center"><img src="gmwm15-1.png" alt=" " width="100%">

---

The "true" data generating used to generate `Xt` was given by

```r
model
```

```out
## 
## Guess Starting Values: FALSE 
##   Terms Initial.Values
##     AR1           0.98
##  SIGMA2           0.02
##      WN           1.00
## The model will be initiated using the initial values you supplied.
```

---

and therefore the GMWM provides reasonable estimated parameters. We can repeat the same process with the perturbed version of `Xt` which we called `Yt`:

```r
mod_Yt = gmwm(AR1() + WN(), Yt)
summary(mod_Yt)
```

```out
## Model Information: 
##         Estimates     CI Low    CI High          SE
## AR1    0.92798049 0.91530822 0.93792462 0.006874897
## SIGMA2 0.04204889 0.03374582 0.05023738 0.005013077
## WN     2.33387079 2.27626921 2.38802446 0.033971184
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 1.8197
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 1.82
## P-Value: 0.08  CI: (0.03, 0.14)
## 
## 
## To replicate the results, use seed: 1337
```

---

```r
plot(mod_Yt)
```

<div style="text-align:center"><img src="gmwm16-1.png" alt=" " width="100%">


---

In this case, the estimation is quite poor and, for example, the variance of the `WN()` is largely overestimated. Alternatively, we can used the robust estimator as follows:

```r
mod_Yt_rob = gmwm(AR1() + WN(), Yt, robust = TRUE)
summary(mod_Yt_rob)
```

```out
## Model Information: 
##         Estimates     CI Low   CI High          SE
## AR1    0.96411745 0.95590123 0.9709290 0.004568117
## SIGMA2 0.03617941 0.03044835 0.0418255 0.003458406
## WN     0.98016837 0.95280480 1.0066039 0.016353778
## 
## > The parameter estimates shown are bootstrapped! To use these results, please save the summary object.
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 0.1657
## 
## Bootstrapped Goodness of Fit: 
## Test Statistic: 0.17
## P-Value: 0.14  CI: (0.07, 0.21)
## 
## 
## To replicate the results, use seed: 1337

```

---

```r
plot(mod_Yt_rob)
```
<div style="text-align:center"><img src="gmwm17-1.png" alt=" " width="100%">


In this case, the result are much closer to the ones obtained on `Xt` and illustrates the robustness of the estimator.
