---
type: slides
---

# Example: Navchip Gyroscope

---

This example is based on data obtained from navchip gyroscope. The data can be loaded from the `imudata` R package as follows:

```r
# Load Navchip
data(navchip, package = "imudata")

# Let's pick Gyro Y
Yt = navchip[,2]
```

---

Our first step is to plot the WV:

```r
# Plot wv 
plot(wvar(Yt))
```

<div style="text-align:center"><img src="gmwm35-1.png" alt=" " width="80%"></div>

---

Based on the previous graph, a possible starting model is `QN() + WN() + AR1()`:

```r
mod1 = gmwm(QN() + WN() + AR1(), Yt)
plot(mod1)
```

<div style="text-align:center"><img src="gmwm36-1.png" alt=" " width="90%"></div>

---

Clearly, the fit is quite poor in the middle and on the right-hand side of the WV. So we consider adding a `RW()` to improve the fit:

```r
mod2 = gmwm(QN() + WN() + AR1() + RW(), Yt)
plot(mod2)
```

<div style="text-align:center"><img src="gmwm37-1.png" alt=" " width="90%"></div>

---

In this last graph the match between empirical and model-based WV is quite good at the first and last scales. To improve the fit in the "middle" of the WV, we consider adding additional AR1():

```r
mod3 = gmwm(QN() + WN() + 2*AR1() + RW(), Yt)
plot(mod3) 
```

<div style="text-align:center"><img src="gmwm38-1.png" alt=" " width="90%"></div>

---

```r
summary(mod3, inference = TRUE)
```

```out
## Model Information: 
##           Estimates        CI Low      CI High           SE
## QN     2.262498e-06  2.259122e-06 2.265874e-06 2.052517e-09
## WN     7.430815e-07  7.406982e-07 7.454648e-07 1.448924e-09
## AR1    9.983817e-01  9.983817e-01 9.983817e-01 1.512637e-14
## SIGMA2 2.704812e-11  2.627811e-11 2.781813e-11 4.681347e-13
## AR1    9.999715e-01  9.999715e-01 9.999715e-01 1.966740e-14
## SIGMA2 7.472544e-13  6.248774e-13 8.696315e-13 7.439997e-14
## RW     4.071412e-14 -1.226787e-14 9.369611e-14 3.221076e-14
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 25.3827
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 1972.23 on 14 degrees of freedom
## The resulting p-value is: 0
```

---

```r
mod4 = gmwm(QN() + WN() + 3*AR1() + RW(), Yt)
plot(mod4) 
```

<div style="text-align:center"><img src="gmwm39-1.png" alt=" " width="90%"></div>

---

```r
summary(mod4, inference = TRUE)
```

```out
## Model Information: 
##           Estimates        CI Low      CI High           SE
## QN     2.283112e-06  2.279327e-06 2.286897e-06 2.301259e-09
## WN     7.061277e-07  7.032309e-07 7.090246e-07 1.761167e-09
## AR1    9.804320e-01  9.804320e-01 9.804320e-01 2.970453e-15
## SIGMA2 2.211797e-10  2.123813e-10 2.299780e-10 5.349009e-12
## AR1    9.999766e-01  9.999766e-01 9.999766e-01 2.321049e-14
## SIGMA2 5.982079e-13  4.676949e-13 7.287209e-13 7.934625e-14
## AR1    9.991688e-01  9.991688e-01 9.991688e-01 1.648007e-14
## SIGMA2 1.126672e-11  1.067841e-11 1.185504e-11 3.576717e-13
## RW     3.935597e-14 -1.856617e-14 9.727810e-14 3.521416e-14
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 8.4062
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 520.44 on 12 degrees of freedom
## The resulting p-value is: 0
```

---

```r
mod5 = gmwm(QN() + WN() + 4*AR1() + RW(), Yt)
plot(mod5) 
```

<div style="text-align:center"><img src="gmwm40-1.png" alt=" " width="90%"></div>

---

```{r, cache = TRUE}
summary(mod5, inference = TRUE)
```

```out
## Model Information: 
##           Estimates        CI Low      CI High           SE
## QN     2.292462e-06  2.288301e-06 2.296623e-06 2.529530e-09
## WN     6.872690e-07  6.836690e-07 6.908689e-07 2.188624e-09
## AR1    9.521500e-01  9.521500e-01 9.521500e-01 1.913789e-15
## SIGMA2 6.532230e-10  6.222986e-10 6.841474e-10 1.880072e-11
## AR1    9.999574e-01  9.999574e-01 9.999574e-01 1.747564e-14
## SIGMA2 8.170266e-13  5.764833e-13 1.057570e-12 1.462400e-13
## AR1    9.999976e-01  9.999976e-01 9.999976e-01 4.693441e-15
## SIGMA2 7.212904e-14 -3.943085e-13 5.385665e-13 2.835739e-13
## AR1    9.987705e-01  9.987705e-01 9.987705e-01 2.013915e-14
## SIGMA2 1.719572e-11  1.648480e-11 1.790664e-11 4.322105e-13
## RW     2.114056e-14 -3.185634e-13 3.608445e-13 2.065253e-13
## 
## * The initial values of the parameters used in the minimization of the GMWM objective function 
##   were generated by the program underneath seed: 1337. 
## 
## Objective Function: 12.3977
## 
## Asymptotic Goodness of Fit: 
## Test Statistic: 790.16 on 10 degrees of freedom
## The resulting p-value is: 0
```

---

The last four models can be compared graphically as follows:

```{r gmwm41, fig.align='center', fig.width=10, fig.height=8, cache=TRUE}
compare_models(mod2, mod3, mod4, mod5, facet.label = c('M2', 'M3', 'M4', 'M5'))
```

<div style="text-align:center"><img src="gmwm41-1.png" alt=" " width="80%"></div>

---

The last model: `QN() + WN() + 3*AR1() + RW()` appears to provide the best fit. However, the model `QN() + WN() + 2*AR1() + RW()` is a reasonable alternative.